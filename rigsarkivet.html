<!doctype html>
<html lang="da">
	<head>
		<meta charset="utf-8">

		<title>Case</title>

		<meta name="description" content="Jobinterview">
		<meta name="author" content="Jakob Kofoed Janot">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/rigsarkivet.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="plugin/highlight/atom-one-dark.css">
		<style>

			@font-face {
				font-family: "Ra-Gorm-Semibold";
				src: url("https://www.rigsarkivet.dk/wp-content/themes/rigsarkivet/assets/fonts/RAGorm-SemiBold.woff2") format("woff2"),
						url("https://www.rigsarkivet.dk/wp-content/themes/rigsarkivet/assets/fonts/RAGorm-SemiBold.woff") format("woff");
				font-weight: 600;
				font-style: normal;
				font-display: swap;
			}
  
			@font-face {
				font-family: "Ra-Harald";
				src: url("https://www.rigsarkivet.dk/wp-content/themes/rigsarkivet/assets/fonts/RAHarald-Medium.woff2") format("woff2"),
						url("https://www.rigsarkivet.dk/wp-content/themes/rigsarkivet/assets/fonts/RAHarald-Medium.woff") format("woff");
				font-weight: normal;
				font-style: normal;
				font-display: swap;
			}
  
			@font-face {
				font-family: "Ra-Harald-Semibold";
				src: url("https://www.rigsarkivet.dk/wp-content/themes/rigsarkivet/assets/fonts/RAHarald-SemiBold.woff2") format("woff2"),
						url("https://www.rigsarkivet.dk/wp-content/themes/rigsarkivet/assets/fonts/RAHarald-SemiBold.woff") format("woff");
				font-weight: 600;
				font-style: normal;
				font-display: swap;
			}
	  
		</style>
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Rigsarkivet</h1>
					<p>Jobinterview</p>
				</section>

				<section>
					<h1>Nyt bevaringsformat til regneark</h2>
				</section>

				<section>
					<h1>Indhold</h1>
					<ul>
						<li>Introduktion</li>
						<li>Baggrund</li>
						<li>XML som bevaringsformat</li>
						<li>Overgangen til det nye format</li>
					</ul>
				</section>

				<!-- Baggrund -->
				<section>
					<section>
						<h1>Baggrund</h1>
					</section>

					<section>
						<h2>Regneark</h3>
					</section>

					<section>
						<p>Program hvormed man kan lave beregninger og opstille data i tabelform.</p>
					</section>

					<section>
						<p>En af de mest udbredte m√•der at gemme data p√•.</p>
					</section>

					<section>
						<p>Historisk set:</p>
						<ul>
							<li>Lotus 1-2-3</li>
							<li>Excel</li>
							<li>Numbers</li>
							<li>OpenOffice Calc</li>
							<li>Google Sheets</li>
						</ul>
					</section>

					<section>
						<ul>
							<li>Nemt at bruge</li>
							<li>Nemt at dele data med andre.</li>
						</ul>
					</section>

					<section>
						<h3>Struktur?</h3>
					</section>

					<section>
						<p style="font-size: 80px">üò¨</p>
					</section>

					<section>
						<p>Modsat databaser - ingen krav til skema-definition</p>
					</section>

					<section>
						<p>Alligevel er der struktur</p>
					</section>

					<section>
						<p>Fx navngivne worksheets, der best√•r af r√¶kker og kolonner.</p>
					</section>

					<section>
						<p>Men ofte meget renderingsorienteret, vha. positionering af tal og tekst.</p>
					</section>

					<section>
						<h3>En titel</h3>
						<p>tekst i en celle, der er centreret og skrevet med fed skrift.</p>
					</section>
										
					<section>
						<p>Brugerdefinerede formler refererer til celler ved deres position, fx <code>=B1+B2</code></p>
						<p>Hvad er <code>B1</code> og <code>B2</code>?</p>
					</section>

					<section>
						<img src="assets/rigsarkivet/images/b1-b2.png" style="width: 50%;"/>
					</section>
					
					<section>
						<p>Du kan ogs√• referere til celler i navngivet form, fx <code>=Areal*Pris</code></p>
						<p>Men det er der jo ingen der g√∏r</p>
					</section>

					<section>
						<p>Alts√•, ingen semantik i data eller formler</p>
					</section>
					
					<section>
						<p>Regneark er ikke data-only</p>
					</section>

					<section>
						<p>Regneark er data og formatering/rendering</p>
					</section>

					<section>
						<p>WYSIWYG</p>
						<p>Vi er n√∏dt til at anvende Excel for at forst√• data</p>
					</section>

					<section>
						<p>Er TIFF det bedste format til at gemme regneark?</p>
					</section>

					<section>
						<p>Fordele:</p>
						<ul>
							<li>Excel (eller andet program) er ikke n√∏dvendigt</li>
							<li>Visuel information bevares</li>
							<li>Diagrammer og grafer bevares</li>
						</ul>
					</section>

					<section>
						<p>Ulemper:</p>
						<ul>
							<li>Sv√¶rt at genskabe data</li>
							<li>Formler er ikke tilg√¶ngelige</li>
						</ul>
					</section>
					
					<section>
						<p>Men kan vi undv√¶re "beregningerne"?</p>
					</section>

					<section>
						<p>Hvordan kom vi frem til det automatisk beregnede tal, der st√•r i cellen?</p>
					</section>

					<section>
						<p>Var tallet v√¶sentlig for en historisk beslutning?</p>
					</section>

					<section>
						<p>En regnefejl?</p>
					</section>

					<section>
						<p>Hvorfor overveje et nyt format?</p>
					</section>
					
					<section>
						<p>Noget information g√•r tabt</p>
					</section>

					<section>
						<p>Vi begr√¶nser anvendelsen af data og formler</p>
					</section>
				</section>

				<!-- XML som bevaringsformat -->
				<section>
					<section>
						<h1>XML som bevaringsformat</h1>
					</section>

					<section>
						<p>Vi b√∏r overveje et struktureret format i till√¶g til TIFF</p>
					</section>

					<section>
						<p>XML er et struktureret format</p>
					</section>

					<section>
						<p>En .xlsx-fil er en zip-fil med XML-filer i OpenXML formatet</p>
					</section>

					<section>
						<p>XML er et eXtensible</p>
					</section>

					<section>
						<p>Kan du leve med at anvende '<' og '>'?</p>
					</section>

					<section>
						<p>Kan du definere din struktur i et skema?</p>
					</section>

					<section>
						<p>... s√• har du et nyt fil-format</p>
					</section>
				
					<section>
						<p>XML giver mulighed for at definere semantik</p>
					</section>

					<section>
						<p>XML d√∏r ikke i morgen</p>
					</section>

					<section>
						<p>Version 1.0 - 26 √•r siden</p>
						<p>Version 1.1 - 17 √•r siden</p>
					</section>

					<section>
						<p>Alverdens filformater baserer sig p√• XML</p>
					</section>

					<section>
						<p>Eksempler: SVG, MathML, XHTML, ODF, OOXML, GML, EPUB, RSS, MusicXML, XBRL, etc.</p>
					</section>

					<section>
						<p>Er det XML - er der en palette af v√¶rkt√∏jer</p>
					</section>

					<section>
						<p>Valid√©r med skemaer</p>
					</section>

					<section>
						<p>S√∏g med XPath</p>
					</section>

					<section>
						<p>Transform√©r med XSLT</p>
					</section>

					<section>
						<p>Supporteret i alle programmeringssprog, databaser osv.</p>
					</section>

					<section>
						<p>XML-teknologier er internationale standarder og specifikationer er √•bne</p>
					</section>

					<section>
						<p>S√•, XML forsvinder ikke i morgen, XML √¶ndres ikke i morgen</p>
					</section>

					<section>
						<p>Hvorfor ikke bruge OpenXML?</p>
					</section>

					<section>
						<p>OpenXML er en ECMA standard</p>
					</section>

					<section>
						<p>Download RelaxNG-skemaet for OpenXML fra:</p>
						<p>https://ecma-international.org/publications-and-standards/standards/ecma-376/</p>
					</section>

					<section>
						<p>Ulempen ved OpenXML - en meget kompleks standard</p>
					</section>

					<section>
						<img src="assets/rigsarkivet/images/xlsx-visning.png" style="width: 50%;"/>
					</section>

					<section>
						<img src="assets/rigsarkivet/images/xlsx-unzip.png" style="width: 50%;"/>
					</section>

					<section>
						<p>xl/worksheets/sheet1.xml</p>
						<img src="assets/rigsarkivet/images/xlsx-sheet1-1.png" style="width: 50%;"/>
					</section>

					<section>
						<p>xl/worksheets/sheet1.xml</p>
						<img src="assets/rigsarkivet/images/xlsx-sheet1-2.png" style="width: 50%;"/>
					</section>

					<section>
						<p>xl/sharedStrings.xml</p>
						<img src="assets/rigsarkivet/images/xlsx-sheet1-3.png" style="width: 50%;"/>
					</section>

					<section>
						<p>OpenDocument Format (ODF) er en ISO standard</p>
						<p>https://github.com/oasis-tcs/odf-tc/blob/master/src/main/resources/odf1.4/OpenDocument-v1.4-schema.rng</p>
					</section>

					<section>
						<p>ODF er et "bedre" OpenXML</p>
					</section>

					<section>
						<p>ODF er f√∏dt med "RDFa" - Resource Description Framework in Attributes</p>
					</section>

					<section>
						<p>RDF er en anden W3C standard, for metadata</p>
					</section>

					<section>
						<h2>Forslag</h2>
					</section>

					<section>
						<p>Vi b√∏r overveje at gemme regneark i XML-format i till√¶g til TIFF</p>
					</section>

					<section>
						<p>OOXML eller ODF?</p>
					</section>

					<section>
						<p>Begge formater er veldefinerede</p>
					</section>

					<section>
						<p>CSV er ikke et godt match, da regneark er mere end en tabel</p>
					</section>

					<section>
						<p>OOXML er komplekst, men udbredt</p>
					</section>

					<section>
						<p>Use case: Sprogmodeller</p>
					</section>

					<section>
						<p>Stort behov for at anvende semantik i dokumenter i forb. med tr√¶ning af LLM'er</p>
					</section>

					<section>
						<p>H√∏j skalerbarhed = snedige mennesker laver snedige l√∏sninger</p>
					</section>

					<section>
						<p>¬Ø\_(„ÉÑ)_/¬Ø</p>
					</section>

					<section>
						<p>V√¶sentligt: Arkiver skemaerne m.v. fra ECMA/ISO</p>
					</section>
				</section>

				<!-- Overgangen til det nye format -->
				<section>
					<section>
						<h1>Overgangen til det nye format</h1>
					</section>

					<section>
						<p>Tabsfri konvertering .xls (bin√¶rt) til .xlsx (XML)?</p>
					</section>

					<section>
						<p>Lotus Notes?, Numbers?</p>
					</section>

					<section>
						<h2>Samarbejde med eksterne interessenter</h2>
					</section>

					<section>
						<p>Et lovkrav - ikke en naturlig driver</p>
					</section>

					<section>
						<p>Skatteborgers penge</p>
					</section>

					<section>
						<p>Pragmatiske l√∏sninger</p>
					</section>

					<section>
						<p>Indrage data-leverand√∏r i udvikling af specifikation</p>
					</section>

					<section>
						<p>Iterativ udvikling af specifikation og f√∏rste-implementering</p>
					</section>

					<section>
						<h2>Samarbejde med interne interessenter</h2>
					</section>

					<section>
						<p>Involvere testere og arkivarer</p>
					</section>
				
					<section>
						<p>Acceptance test af konvertering p√• virkelige regneark</p>
					</section>

					<section>
						<p>Involvere IT-udviklere</p>
					</section>

					<section>
						<p>Hvordan skal en indhentningspipeline fungere?</p>
					</section>

					<section>
						<p>Arkiveringsparkke-format - behov for √¶ndringer?</p>
					</section>
					
					<section>
						<p>Beskrive krav til XML bevaringsformater, bl.a. ved henvisning 
							til de konkrete versioner af struktur skema'erne</p>
					</section>

					<section>
						<p>Evt. udvikle schematron schema, hvor struktur skema'erne ikke er tilstr√¶kkelige</p>
					</section>

					<section>
						<p>Schematron definerer business-rules (assertions), der ikke kan defineres i skemaer</p>
					</section>

					<section>
						<h2>Eksempel p√• Schematron</h2>
						<pre><code class="hljs language-xml" data-trim>
							&lt;schematron xmlns="http://purl.oclc.org/dsdl/schematron"&gt;
								&lt;ns prefix="x" uri="http://schemas.openxmlformats.org/spreadsheetml/2006/main"/&gt;
						
								&lt;pattern id="check-for-missing-worksheets"&gt;
										&lt;title&gt;Check for missing worksheet files in xl/worksheets directory&lt;/title&gt;
										
										&lt;!-- Rule to check that each sheet has a corresponding worksheet file --&gt;
										&lt;rule context="x:sheets/x:sheet"&gt;
											&lt;assert test="doc-available(concat('xl/worksheets/sheet', @sheetId, '.xml'))"&gt;
													Worksheet file 'xl/worksheets/sheet{@sheetId}.xml' is missing.
											&lt;/assert&gt;
									&lt;/rule&gt;
							&lt;/pattern&gt;
						&lt;/schematron&gt;
						</code></pre>
					</section>

					<section>
						<p>Use case: Begr√¶nse indholdet, uden at √¶ndre struktur skema'er</p>
					</section>

					<section>
						<p>Pointe: Skema-drevet udvikling er et st√¶rkt redskab</p>
					</section>

					<section>
						<p>Vi deklarer, hvad vi √∏nsker = low-code l√∏sning</p>
					</section>

					<section>
						<p>Deklarativt og t√¶t p√• specifikationen</p>
					</section>

					<section>
						<p>Udvikle v√¶rkt√∏jer til validering af regnark i XML-format</p>
					</section>

					<section>
						<p>Testk√∏rsel af validering p√• stort datamateriale, tilf√¶ldigt udvalgt</p>
					</section>

					<section>
						<p>Jeg forestiller mig at stille skema'er, eksempel-filer, dokumentation og kildekode 
							til r√•dighed via git repository</p>
					</section>
				</section>

			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/zoom/zoom.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/search/search.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/externalcode/externalcode.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>

			// Also available as an ES module, see:
			// https://revealjs.com/initialization/
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealExternalCode, RevealHighlight]
			});

		</script>

	</body>
</html>